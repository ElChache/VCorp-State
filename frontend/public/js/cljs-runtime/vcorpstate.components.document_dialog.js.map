{"version":3,"sources":["vcorpstate/components/document_dialog.cljs"],"mappings":";AAOA;;;oEAAA,pEAAOA,gJAEJC;AAFH,AAGE,GAAI,EAAK,AAACC,cAAID,gBACL,uBAAA,WAAAE,lCAACC;AAAD,AAAS,OAAA,qFAAAD;GAAWF;AAD7B;;AAAA;;;AAKF;;;+DAAA,/DAAOI,sIAEJC;AAFH,AAGE,IAAMC,kBAAU,oDAAA,pDAACC,6CAAEF;IACbG,UAAQ,CAAA,2EACI,mBAAA,8BAAA,/CAAIF;AAFtB,AAAA,0FAAA,qDAAA,2CAAA,wDAKiBE,gBACd,mBAAA,QAAA,zBAAIF;;AAET;;;wDAAA,xDAAOG,wHAEJT;AAFH,AAGE,cAAA,mFAAA,2CAAA,oDAAA,qDAAA,uDAAA,mBAAA,2CAAA,oDAAA,0DAAA,uDAAA,iBAAA,2CAAA,oDAAA,2DAAA,uDAAA,7uBAAMU;IAGAC,cAAY,WAAKC,WAAWC;AAAhB,AACE,IAAAC,WAAMF;IAANE,eAAA,EAAA,CAAAA,oBAAAC,oBAAA,AAAAD,aAAA;AAAA,AAAA,QAAAA;KAAA;AAAA,0FAAA,qDAAA,2CAAA,wDAAA,oCACoD,AAAA,mFAAOD;;;KAD3D;AAAA,4IAAA,2CAAA,7FAEWI,uJAA2B,kHAAA,QAAA,xGAAI,AAAA,qFAAQJ;;;KAFlD;AAAA,0FAAA,mDAAA,2CAAA,wDAAA,qBAAA,mFAAA,yDAAA,2CAAA,wDAAA,6NAAA,6DAAA;AAAA,AAKiC,8BAAA,mFAAA,8KAAA,xRAACK,8LAAkC,AAAA,gFAAKL;WALzE,oBAAA,mFAAA,yDAAA,2CAAA,wDAAA,wNAAA,6DAAA;AAAA,AAQiC,8BAAA,mFAAA,8KAAA,xRAACK,8LAAkC,AAAA,gFAAKL;WARzE;;;;AAAA,MAAA,KAAAG,MAAA,CAAA,mEAAAF;;;;AAJpB,AAAA,yIAAA,2CAAA,+DAAA,mEAAA,+EAAA,wEAAA,kCAAA,4DAAA,jdAcGK,+IAAwBnB,qEACGU,2EACIC;;AAIpC;;;;;;;;wDAAA,xDAAMS;AAAN,AAQE,qBAAA,AAAAC,jBAAMC,iCAAU,sDAAA,mFAAA,zIAACC;6BAAjB,AAAAF,zBACMG,yCAAwB,sDAAA,mFAAA,zIAACD;0BAD/B,AAAAF,tBAEMI,sCAAqB,sDAAA,mFAAA,zIAACF;IACtBG,aAAW,AAACC,4CAAIF,oBAAoBD;IACpCxB,YAAU,8BAAA,0GAAA,tHAAM0B,YAAW,AAAA,8FAAYA;IACvCE,oBAAkB,AAAC7B,kEAA4BC;AALrD,AAOE,oBAAMsB;AAAN,AAAA,+IAAA,2CAAA,+EAAA,/KACGO;AADH,AAC6C,8BAAA,mFAAA,1GAACX;WAD9C,uIAAA,2CAAA,oKAAA,mFAAA,mDAAA,2CAAA,wDAAA,eAAA,mFAAA,mDAAA,2CAAA,wDAAA,kCAAA,mFAAA,qDAAA,2CAAA,wDAAA,gCAAA,kBAAA,0LAAA,mFAAA,mDAAA,2CAAA,wDAAA,eAAA,mFAAA,iDAAA,2CAAA,wDAAA,iDAAA,oBAAA,mKAAA,wIAAA,uIAAA,2CAAA,6DAAA,3xEAGIY,qJAA4B,CAAA,2DAAoBN,q6BAM9CpB,6DAAuBwB,iqBAKxBnB,sDAAgBT,6GAEjB+B,wIACCC;AAjBL,AAiBqC,8BAAA,mFAAA,1GAACd;WAjBtC;;AAAA","names":["vcorpstate.components.document-dialog/calculate-collection-status","documents","cljs.core/seq","p1__13529#","cljs.core/every?","vcorpstate.components.document-dialog/collection-status-pill","status","is-ready?","cljs.core._EQ_","classes","vcorpstate.components.document-dialog/documents-table","columns","render-cell","column-key","row-data","G__13530","cljs.core/Keyword","js/Error","vcorpstate.components.ui.status-pill/status-badge","re-frame.core/dispatch","vcorpstate.components.ui.data-table/data-table","vcorpstate.components.document-dialog/document-dialog","cljs.core/deref","is-open?","re_frame.core.subscribe","selected-document-slug","collections-by-slug","collection","cljs.core.get","collection-status","vcorpstate.components.ui.dialog-modal/dialog-overlay","vcorpstate.components.ui.dialog-modal/dialog-header","vcorpstate.components.ui.dialog-modal/dialog-actions","vcorpstate.components.ui.dialog-modal/dialog-button"],"sourcesContent":["(ns vcorpstate.components.document-dialog\n  \"Document collection status dialog component\"\n  (:require [re-frame.core :as rf]\n            [vcorpstate.components.ui.dialog-modal :as modal]\n            [vcorpstate.components.ui.status-pill :as pill]\n            [vcorpstate.components.ui.data-table :as table]))\n\n(defn- calculate-collection-status\n  \"Calculate overall collection status based on document statuses\"\n  [documents]\n  (if (and (seq documents) \n           (every? #(:ready %) documents))\n    \"ready\"\n    \"not ready\"))\n\n(defn- collection-status-pill\n  \"Non-clickable status pill for collection overall status\"\n  [status]\n  (let [is-ready? (= status \"ready\")\n        classes (str \"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium \"\n                    (if is-ready?\n                      \"bg-green-100 text-green-800\"\n                      \"bg-gray-100 text-gray-800\"))]\n    [:span {:class classes}\n     (if is-ready? \"Ready\" \"Not Ready\")]))\n\n(defn- documents-table\n  \"Table showing all documents in the collection with their status and action buttons\"\n  [documents]\n  (let [columns [{:key :slug :label \"Document\"}\n                 {:key :status :label \"Status\"}\n                 {:key :actions :label \"Actions\"}]\n        render-cell (fn [column-key row-data]\n                      (case column-key\n                        :slug [:span {:class \"font-medium text-gray-900\"} (:slug row-data)]\n                        :status [pill/status-badge {:status (if (:ready row-data) \"ready\" \"not ready\")}]\n                        :actions [:div {:class \"flex gap-3\"}\n                                  [:button {:class \"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-1 transition-all duration-200 shadow-sm\"\n                                            :on-click #(rf/dispatch [:set-document-status (:id row-data) true])}\n                                   \"Set Ready\"]\n                                  [:button {:class \"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-1 transition-all duration-200 shadow-sm\"\n                                            :on-click #(rf/dispatch [:set-document-status (:id row-data) false])}\n                                   \"Set Not Ready\"]]))]\n    [table/data-table {:data documents\n                       :columns columns\n                       :render-cell render-cell\n                       :empty-message \"No documents in this collection\"\n                       :row-key :slug}]))\n\n(defn document-dialog\n  \"Dialog for viewing and managing document collection status.\n  \n  Shows:\n  - Collection name and overall status (calculated from documents)\n  - Table of all documents with clickable status pills\n  - Close button to dismiss dialog\"\n  []\n  (let [is-open? @(rf/subscribe [:document-dialog-open?])\n        selected-document-slug @(rf/subscribe [:selected-document])\n        collections-by-slug @(rf/subscribe [:data/collections-with-stats])\n        collection (get collections-by-slug selected-document-slug)\n        documents (when collection (:documents collection))\n        collection-status (calculate-collection-status documents)]\n    \n    (when is-open?\n      [modal/dialog-overlay {:on-backdrop-click #(rf/dispatch [:hide-document-dialog])}\n       \n       [modal/dialog-header {:title (str \"Collection: \" selected-document-slug)}]\n       \n       ;; Collection status section\n       [:div {:class \"mb-6\"}\n        [:div {:class \"flex items-center gap-2\"}\n         [:span {:class \"text-sm text-gray-600\"} \"Status:\"]\n         [collection-status-pill collection-status]]]\n       \n       ;; Documents section\n       [:div {:class \"mb-6\"}\n        [:h3 {:class \"text-md font-medium text-gray-900 mb-3\"} \"Documents\"]\n        [documents-table documents]]\n       \n       [modal/dialog-actions\n        [modal/dialog-button {:on-click #(rf/dispatch [:hide-document-dialog])}\n         \"Close\"]]])))"]}