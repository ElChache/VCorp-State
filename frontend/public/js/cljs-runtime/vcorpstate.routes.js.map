{"version":3,"sources":["vcorpstate/routes.cljs"],"mappings":";AAIA,AAAA,8BAAA,sCAAAA,pEAAME;AAAN,AAAA,IAAAD,WAAA,AAAA;AAAA,AAAA,QAAAA;KAAA;AAAA,OAAAC;;;KAAA;AAAA,OAAAA,0DAAA,CAAA,UAAA;;;;AAAA,MAAA,KAAAC,MAAA,CAAA,8DAAA,AAAA;;;;;AAAA,CAAA,4DAAA,5DAAMD;AAAN,AAEG,OAACE,0DAAUC;;;AAFd,CAAA,4DAAA,5DAAMH,uEAGFI;AAHJ,AAAA;AAKG,IAAMC,OAAK,iBAAAC,mBAAIF;AAAJ,AAAA,oBAAAE;AAAAA;;AAAQH;;;IACbE,WAAK,EAAI,uCAAA,vCAACE,kCAAiBF,WAAU,kDAAA,lDAACG,6CAAKH,UAAQA;AADzD,AAEE,GACE,EAAI,AAACI,uBAAOJ,eAAM,sDAAA,tDAACK,6CAAEL;AADvB,kDAAA,qDAAA;;AAAA,GAEE,2CAAA,3CAACE,kCAAiBF;AAClB,IAAMM,SAAO,kEAAIN,nDAAK,4DAAA,5DAACO,fAAgBC;AAAvC,AACE,IAAAC,qBAAY,AAACE,qBAAWL;AAAxB,AAAA,oBAAAG;AAAA,SAAAA,LAASC;AAAT,AAAA,kDAAA,qDAAA,2DAAA,wDAAA,2CAAA,kDAC+BA;;AAD/B,kDAAA,qDAAA;;;AAJJ,AAAA,kDAAA,qDAAA;;;;;;AAPL,CAAA,sDAAA,tDAAMf;;AAAN,AAgBA,wCAAA,xCAAMiB;AAAN,AAAA;AAEE,IAAMC,QAAM,AAAChB;AAAb,AACE,YAAA,ZAACiB,gCAAmCD;;AAEpC,uBAAA,mFAAA,1GAACE,0KAAwBF;;AAGzB,IAAAG,WAAM,AAAA,mFAAOH;IAAbG,eAAA,EAAA,CAAAA,oBAAAC,oBAAA,AAAAD,aAAA;AAAA,AAAA,QAAAA;KAAA;AACQ,AACE,YAAA,ZAACF;;AACD,uBAAA,mFAAA,6EAAA,vLAACC;;AACD,8BAAA,mFAAA,1GAACA;;;KAJX;AAKW,IAAMG,aAAW,qDAAA,mFAAA,wDAAA,hMAACC,+CAAON;AAAzB,AACE,YAAA,ZAACC,2CAA8CI;;AAC/C,uBAAA,mFAAA,6EAAA,vLAACH;;AACD,uBAAA,mFAAA,1GAACA,8LAAmCG;;AACpC,uBAAA,mFAAA,1GAACH,iMAAsCG;;AACvC,8BAAA,mFAAA,1GAACH,sLAAgCG;;;;AAV9C,MAAA,KAAAtB,MAAA,CAAA,mEAAAoB;;;;AAYJ,4CAAA,5CAAMI,gGAAoBP;AAA1B,AAAA;AAEE,IAAMQ,OAAK,iBAAAC,WAAM,AAAA,mFAAOT;IAAbS,eAAA,EAAA,CAAAA,oBAAAL,oBAAA,AAAAK,aAAA;AAAA,AAAA,QAAAA;KAAA;AAAA;;;KAAA;AAEW,QAAA,yDAAkB,qDAAA,mFAAA,wDAAA,hMAACH,+CAAON;;;;AAFrC,MAAA,KAAAjB,MAAA,CAAA,mEAAA0B;;;;AAAX,AAGE,CAAMxB,uBAAwBuB;;AAC9B,OAACT;;AAEL,sCAAA,tCAAMW;AAAN,AAAA;AAGE,AAACX;;AAGD,wBAAA,xBAAmBY,mCAAqBZ;;AACxC,+BAAA,xBAAmBY,qCAAuBZ","names":["var_args","G__11380","vcorpstate.routes/parse-url","js/Error","vcorpstate.routes.parse_url","js/window.location.hash","url","path","or__5002__auto__","clojure.string/starts-with?","cljs.core.subs","cljs.core/empty?","cljs.core._EQ_","id-str","clojure.string.split","cljs.core/last","temp__5802__auto__","id","cljs.core/parse-long","vcorpstate.routes/handle-route-change","route","js/console.log","re-frame.core/dispatch","G__11381","cljs.core/Keyword","project-id","cljs.core.get_in","vcorpstate.routes/navigate-to-route!","hash","G__11382","vcorpstate.routes/init-routes!","js/window"],"sourcesContent":["(ns vcorpstate.routes\n  (:require [re-frame.core :as rf]\n            [clojure.string :as str]))\n\n(defn parse-url \n  ([]\n   (parse-url js/window.location.hash))\n  ([url]\n   \"Parse URL and return route info\"\n   (let [path (or url js/window.location.hash)\n         path (if (str/starts-with? path \"#\") (subs path 1) path)]\n     (cond\n       (or (empty? path) (= path \"/\")) {:name :home}\n       (str/starts-with? path \"/project/\") \n       (let [id-str (-> path (str/split #\"/\") last)]\n         (if-let [id (parse-long id-str)]\n           {:name :project :params {:id id}}\n           {:name :home}))\n       :else {:name :home}))))\n\n(defn handle-route-change []\n  \"Handle route changes and load data based on route\"\n  (let [route (parse-url)]\n    (js/console.log \"Route changed to:\" route)\n    ;; Set the route in db first\n    (rf/dispatch [:set-route route])\n    \n    ;; Load data based on route\n    (case (:name route)\n      :home (do\n              (js/console.log \"Loading home view, dispatching :fetch-projects\")\n              (rf/dispatch [:set-current-view :project-selector])\n              (rf/dispatch [:fetch-projects]))\n      :project (let [project-id (get-in route [:params :id])]\n                 (js/console.log \"Loading project view for ID:\" project-id)\n                 (rf/dispatch [:set-current-view :main])\n                 (rf/dispatch [:set-selected-project project-id])\n                 (rf/dispatch [:graph/load-initial-data project-id])\n                 (rf/dispatch [:websocket/connect project-id])))))\n\n(defn navigate-to-route! [route]\n  \"Navigate to a route and update browser history\"\n  (let [hash (case (:name route)\n               :home \"#/\"\n               :project (str \"#/project/\" (get-in route [:params :id])))]\n    (set! js/window.location.hash hash)\n    (handle-route-change)))\n\n(defn init-routes! []\n  \"Initialize routing\"\n  ;; Handle initial page load\n  (handle-route-change)\n  \n  ;; Handle browser back/forward buttons and hash changes\n  (.addEventListener js/window \"popstate\" handle-route-change)\n  (.addEventListener js/window \"hashchange\" handle-route-change))"]}